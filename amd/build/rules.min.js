/**
 * Rules AMD module for Integration Hub.
 *
 * Handles rule form interactions: service-type label toggle, add/cancel form,
 * and payload template preview via AJAX.
 *
 * @module     local_integrationhub/rules
 * @copyright  2026 Integration Hub Contributors
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_integrationhub/rules",["jquery","core/ajax","core/notification"],(function($,Ajax,Notification){return{init:function(serviceTypes){try{var formContainer=$("#ih-rule-form"),btnAdd=$("#ih-btn-add"),btnCancel=$("#ih-btn-cancel"),btnPreview=$("#ih-btn-preview"),templateField=$("#ih-template"),serviceField=$("#ih-serviceid"),endpointField=$("#ih-endpoint"),endpointLabel=$('label[for="ih-endpoint"]'),methodContainer=$("#ih-method-container"),updateEndpointLabel=function(){var svcId=serviceField.val(),type=serviceTypes[svcId]||"rest";"amqp"===type?(endpointLabel.text("Queue Name / Routing Key"),endpointField.attr("placeholder","e.g. user_sync_queue"),methodContainer.addClass("d-none")):"soap"===type?(endpointLabel.text("SOAP Action / Method"),endpointField.attr("placeholder","e.g. CreateUser"),methodContainer.addClass("d-none")):(endpointLabel.text("Endpoint Path"),endpointField.attr("placeholder","e.g. /api/v1/users"),methodContainer.removeClass("d-none"))};serviceField.length&&(serviceField.on("change",updateEndpointLabel),updateEndpointLabel()),btnAdd.length&&btnAdd.on("click",(function(){$("#ih-ruleid").val("0"),$("#ih-form")[0].reset(),formContainer.removeClass("d-none"),btnAdd.addClass("d-none")})),btnCancel.length&&btnCancel.on("click",(function(){formContainer.addClass("d-none"),btnAdd.removeClass("d-none")})),btnPreview.length&&btnPreview.on("click",(function(e){e.preventDefault();var template=templateField.val();if(template){var eventNameField=$("#ih-eventname"),eventname=eventNameField.length?eventNameField.val():"";Ajax.call([{methodname:"local_integrationhub_preview_payload",args:{template:template,eventname:eventname}}])[0].done((function(response){if(response.success){var content='<pre style="text-align: left; background: #f8f9fa; padding: 10px; border: 1px solid #ddd;">'+response.payload+"</pre>";Notification.alert("Payload Preview",content,"OK")}else Notification.alert("Error",response.error||"Failed to preview payload.","OK")})).fail(Notification.exception)}else Notification.alert("Error","Please enter a template first.","OK")}))}catch(e){Notification.exception(e)}}}}));

//# sourceMappingURL=rules.min.js.map